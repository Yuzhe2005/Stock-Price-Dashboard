# API速率限制问题说明

## 问题：为什么只显示1个股票？

### 原因：Alpha Vantage API速率限制

**免费版限制**：
- ⚠️ **每分钟5次请求**
- ✅ 每天500次请求

**问题**：
- 你的项目配置了30个股票
- 代码同时发送30个API请求（并行）
- 但API每分钟只允许5次请求
- 所以：**只有前5个请求成功，其他25个都失败**
- 如果只看到1个，说明只有1个请求成功

## 解决方案

### 方案1：减少股票数量（推荐）

将股票数量减少到5个或更少：

```typescript
// src/services/sp500Stocks.ts
export function getSP500DemoStocks(): string[] {
  return SP500_STOCKS.slice(0, 5); // 改为5个
}
```

这样每次刷新只发送5个请求，不会超过限制。

### 方案2：添加延迟（串行请求）

修改代码，让请求串行执行，每次请求间隔至少12秒（60秒 ÷ 5 = 12秒）：

```typescript
// 不推荐，因为太慢了
// 30个股票 × 12秒 = 6分钟才能加载完
```

### 方案3：使用多个API Key（如果允许）

如果你有多个API Key，可以轮换使用。

### 方案4：批量API（如果API支持）

检查Alpha Vantage是否支持批量查询（通常不支持）。

## 推荐方案

**使用5个股票**：

1. 打开 `src/services/sp500Stocks.ts`
2. 修改第67行：
   ```typescript
   export function getSP500DemoStocks(): string[] {
     return SP500_STOCKS.slice(0, 5); // 从30改为5
   }
   ```

这样：
- ✅ 每次刷新只发送5个请求
- ✅ 不会超过每分钟5次的限制
- ✅ 可以刷新100次/天（500 ÷ 5 = 100）
- ✅ 加载速度快

## 当前状态检查

如果你想看看到底有多少股票成功加载了，可以：

1. 打开浏览器开发者工具（F12）
2. 查看Console标签
3. 查看Network标签
4. 看有多少API请求成功/失败

## 总结

- **问题**：API速率限制（每分钟5次）
- **原因**：并行发送30个请求，超过限制
- **解决**：减少到5个股票（推荐）
- **结果**：所有股票都能正常显示

